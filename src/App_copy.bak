import { getCounterTime } from "./utils";
import { useEffect, useState } from "react";

function App() {
  const [status, setStatus] = useState("off");
  const [value, setValue] = useState(0);

  useEffect(() => {
    const timerId = setInterval(() => {
      if (status === "on") {
        const newValue = value + 1;
        setValue(newValue);
      }
    }, 1000);

    return () => {
      clearInterval(timerId);
    };
  });

  const handleStartClick = ({ target }) => {
    const newStatus = status === "on" ? "off" : "on";

    if (status !== "wait") {
      setValue(0);
    }
    setStatus(newStatus);
    setStatus(newStatus);
  };

  const handleWaitClick = ({ target }) => {
    setStatus("wait");
  };

  const handleResetClick = ({ target }) => {
    setValue(0);
    setStatus("on");
  };

  return (
    <main className="App">
      <header className="App-header">Counter</header>

      <section>
        <div className="tablo">{getCounterTime(value)}</div>

        <ul className="actions">
          <li className="actions-item">
            <button className="btn btn-start" onClick={handleStartClick}>
              { status === "on" ? "Stop" : "Start"}
            </button>
          </li>
          <li className="actions-item">
            <button className="btn btn-wait" onClick={handleWaitClick}>
              Wait
            </button>
          </li>
          <li className="actions-item">
            <button className="btn btn-reset" onClick={handleResetClick}>
              Reset
            </button>
          </li>
        </ul>
      </section>
    </main>
  );
}

export default App;
